STACK â€“ STRUKTUR OCH ANSVAR
ğŸ”¹ Frontend (React / Vite)
Syfte: UI, anvÃ¤ndarflÃ¶de, PDF-visning, projekt- och mappnavigation
Teknikval:

React + TypeScript

Vite

MUI Joy UI-komponenter

Axios (fÃ¶r all API-kommunikation)

React Router (projektrouting, mappnavigering)

pdf.js (fÃ¶r inline PDF-visning)

JWT-bearer token i varje request

Frontend ska aldrig:

Gissa URL:er

Manipulera filnamn

FÃ¶rsÃ¶ka skapa routinglogik som backend ansvarar fÃ¶r

ğŸ”¹ Backend (Django + DRF)
Syfte: Datahantering, autentisering, rÃ¤ttigheter, struktur, API-servande
Teknikval:

Django 4â€“5

Django REST Framework

djangorestframework-simplejwt (fÃ¶r JWT-autentisering)

PostgreSQL som databas

Djangoâ€™s FileField och upload_to-logik

Custom permissions (t.ex. IsProjectMember)

Versioneringsmodell fÃ¶r PDF:er

MÃ¶nster att fÃ¶lja:

Varje mapp (FileNode) har project_id

Varje PDF (PDFDocument) har project_id + file_node_id

Varje fil sparas med upload_to=f'project_{project_id}/folder_{folder_id}/'

Varje fil nÃ¥s via @xframe_options_exempt-skyddad API-endpoint /api/pdf/<id>/content/

ğŸ”¹ Databasmodell (PostgreSQL via Django ORM)
Nyckelmodeller:

Project

id, name, description, users (many-to-many)

FileNode (mappar)

id, name, parent_id, type='folder', project_id

PDFDocument

id, title, description, file, version, project_id, file_node_id, uploaded_by

FileVersion

file_node_id, version, file, size, created_by

Nyckelrelationer:

PDFDocument.file_node â†’ FileNode.id

FileNode.project â†’ Project.id

Project.users â†’ User.id (via M2M)

ğŸ”¹ API-design (DRF)
MÃ¥ste finnas:

GET /api/projects/ â†’ lista projekt du Ã¤r medlem i

GET /api/files/directories/?project=... â†’ lista mappar i projekt

GET /api/pdf/list/<folder_id>/ â†’ lista PDF:er i mapp

POST /api/pdf/upload/ â†’ ladda upp PDF till en mapp

GET /api/pdf/<id>/content/ â†’ hÃ¤mta PDF-innehÃ¥ll (auth skyddad)

(valfritt: GET /api/pdf/<id>/annotations/)

Autentisering:

JWT-token i headern: Authorization: Bearer <token>

Frontend lagrar token lokalt och lÃ¤gger till automatiskt via Axios interceptor

ğŸ” SÃ¤kerhetskrav & policy
Ã…tgÃ¤rd	Skyddsmekanism
Ladda PDF	Kontrollera request.user âˆˆ project.users
Navigera mappar	Visa endast FileNode.project = user.project
Ã–ppna fil	Endast via /api/pdf/<id>/content/
Visa url	Backend ansvarar â€“ frontend ska bara visa
Ã…tkomstkontroll	Via custom permission class eller i varje vy

ğŸ§© Sammanfattat ansvar
Lager	Ansvarar fÃ¶r
Frontend	Visa data, hÃ¤mta frÃ¥n API, inte gissa nÃ¥got
Backend	Full kontroll pÃ¥ struktur, Ã¥tkomst och URL:er
Databas	Spegla projekt/mapp/fil-struktur, skydd via relationer
API-design	Tydliga endpoints fÃ¶r varje behov, aldrig blanda concerns